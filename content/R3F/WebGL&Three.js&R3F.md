---
title: "WebGL, Three.js, React Three Fiber은 뭘까?"
date: 2023-06-05
subtitle: "WebGL, Three.js, React Three Fiber에 대한 간단한 설명을 정리해 보았습니다."
category: "React Three Fiber"
tags:
  - webgl
  - r3f
  - threejs
background: "r3f/r3f-livingroom.jpeg"
emoji: "🪑"
draft: false
---

</br>
3D 그래픽은 세개의 좌표를 선으로 연결해서 입체적으로 보이게 하고, 다음 좌표를 계산해 다시 렌더링해서 움직이는 것처럼 보이게 하는 것입니다.

</br>
</br>

## WebGL이란?

WebGL은 <b>Web Graphics Library</b>의 약자로 웹상에서 2D 및 3D 그래픽을 렌더링 하기 위해 만들어진 로우 레벨, 즉 저수준의 Javascript API입니다. 여기서 `canvas`라는 요소가 사용되는데 사실 `canvas`는 처음부터 3D 그래픽을 렌더링하진 못했다고 합니다. 하지만 WebGL은 그걸 가능하게 만들었고 더 나아가서 `canvas` 안에 있는 삼각형들을 놀라운 속도의 렌더링을 가능하게 해줍니다. 이게 가능한 이유는 렌더링 가속화를 지원하는 그래픽 하드웨어(`GPU`)를 활용하기 때문입니다.

> Canvas는 웹상에서 도형과 같은 그래픽적인 것을 표현 할때 사용되는 HTML 태그중 하나입니다. 자바스크립트를 이용해서 도형이나 이미지, 그래프, 그래픽 등을 그릴수 있는 html5의 요소로 쉽고 강력한 여러 옵션들을 제공합니다.

</br>

**GPU는 여기서 정확히 어떤 역할을 할까?**

GPU는 <b>Graphic Processing Unit</b>의 약자로 위에서 말했듯이 렌더링 가속화를 해주는데에 큰 역할을 합니다. GPU는 간단한 계산들을 빠르게 할수 있고 많은 연산을 병렬로 동시에 처리 가능하게 해줍니다.

1000개의 삼각형으로 만들어진 하나의 3D 모델을 렌더링할때를 상상해보죠. 1000개라는 숫자는 그렇게 크게 느껴지지 않습니다. 하지만 그 각각의 삼각형은 3개의 점들을 가지고 있고 이로써 우리가 그 하나의 3D 모델을 렌더링할때 GPU는 3000개 점의 위치를 계산해야합니다. 여기서 GPU는 병렬연산을 사용해서 모든걸 동시에 처리할수 있습니다.

3D 모델의 모든 점들이 계산되어 배치되면 모든 삼각형들의 픽셀을 그려야 하는데요. 여기서 한번 더 병렬연산이 픽셀 계산하는데에 사용되며 모든 일 처리를 쉽고 빠르게 할수 있게 해줍니다.

</br>

**“WebGL을 사용해서 3D를 만들어야지!”**

위의 소제목과 같은 생각을 많은 개발자들도 할 뿐만 아니라 저도 했었습니다. 하지만 사실 WebGL은 `Rasterization engine`에 불과하고 하는 역할은 개발자들이 제공한 코드를 기반으로 점, 선, 삼각형을 그려내는 역할을 하는데요. 그렇기에 우리는 점, 선, 삼각형을 사용하는 코드를 작성해야 합니다.

우리는 점들을 배치하고 픽셀을 그리기 위한 지시 사항들을 함수 쌍 형태로 제공해야 합니다. 이 두 함수는 `정점 셰이더`와 `프래그먼트 셰이더`라고 불리고 각자의 역할들은 이렇습니다.

- 정점 셰이더: 정점 위치를 계산을 합니다. WebGL은 함수가 출력하는 위치를 기반으로 점, 선, 삼각형등 다양한 프리미티브를 레스터화 합니다.
- 프래그먼트 셰이더: 그려지는 프리미티브의 각 픽셀에 대한 색상을 계산합니다.

한가지만 말하자면 세이더를 완벽히 마스터하기엔 정말 어렵고 많은 데이터를 세이더에 제공해야 합니다. 3D 모델 변환과 카메라 속성에 따라 점을 배치해야 할때를 상상해보죠. 더 나아가 픽셀에 색을 입힐때 도움이 되는 데이터를 제공 해야 하고 만약 그 장면에 빛을 추가한다면 빛을 받는 삼각형과 안 받는 삼각형의 색상은 달라야 할것입니다. 이 모든것을 하나하나 셰이더에 제공한다는 걸 상상만 했는데도 벌써 머리가 아프군요.

이래서 Native WebGL만 사용해서 3D 개발을 한다는건 참 어렵습니다. 삼각형 하나를 `canvas`에 그리기 위해서 100 라인이 넘는 코드를 써야 할것입니다.

</br>

## Three.js란?

위에서 말했듯이 Native WebGL로만 우리가 원하는 3D 웹 개발을 하기엔 너무 어렵습니다. 이럴때 개발자들이 많이 사용하는것중에 하나인 `Three.js`는 개발자가 웹안에서 3D 개발 경험을 할수 있게 해주는 3D 자바스크립트 라이브러리입니다. 3D 개발을 하고 싶은 개발자들에겐 하나의 빛과 같은 존재처럼 쉽고 강력한 옵션과 기능들을 제공해줍니다. 단 몇줄의 코드로 애니매이션화가 된 3D 장면을 만들수 있게 해줍니다.

</br>

## React Three Fiber이란?

위에서 WebGL과 Three.js에 대한 글들을 늘어놓았지만 사실 React Three Fiber이 이어지는 글들의 메인주제가 될것입니다. React Three Fiber은 `react renderer` 로 three.js를 리액트 문법에 맞게 사용할 수 있도록 해주는 패키지 입니다. 쉽게 말하자면 개발자들이 JSX 문법으로 코드를 쓰면 Three.js로 변환될수 있게 도와주는 패키지입니다.

> JSX는 Javascript에 XML을 추가한 확장한 문법입니다. JSX는 리액트로 프로젝트를 개발할 때 사용되고 있습니다.
